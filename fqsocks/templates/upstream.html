<!DOCTYPE html>
<html>
<head>
    <title>fqrouter</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link href="/assets/bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">
    <link href="/assets/bootstrap/css/bootstrap-theme.css" rel="stylesheet" media="screen">
    <style type="text/css">
        th.sort-header {
            cursor:pointer;
        }
        th.sort-header::-moz-selection,
        th.sort-header::selection {
            background:transparent;
        }
        table th.sort-header:after {
            content:'';
            float:right;
            margin-top:7px;
            border-width:0 4px 4px;
            border-style:solid;
            border-color:#404040 transparent;
            visibility:hidden;
        }
        table th.sort-header:hover:after {
            visibility:visible;
        }
        table th.sort-up:after,
        table th.sort-down:after,
        table th.sort-down:hover:after {
            visibility:visible;
            opacity:0.4;
        }
        table th.sort-up:after {
            border-bottom:none;
            border-width:4px 4px 0;
        }
        table.portrait .tx-speed {
            display: none;
        }
        table.portrait .rx-speed {
            display: none;
        }
        body {
            margin: 8px;
        }
    </style>
</head>
<body>
<ul class="nav nav-tabs">
    <li><a href="/">{{ _('Status', '状态') }}</a></li>
    <li class="active"><a href="javascript:void(0);">{{ _('Uncensored Internet', '墙外的世界') }}</a></li>
    <li><a href="/downstream">{{ _('Friends', '我的小伙伴们') }}</a></li>
    <li><a href="/config">{{ _('Config', '设置') }}</a></li>
</ul>
<table class="table table-striped" id="proxies">
    <thead>
    <tr>
        <th>{{ _('proxy', '代理') }}</th>
        <th class="rx-speed">{{ _('download', '下载') }}</th>
        <th>{{ _('download', '下载') }}</th>
        <th class="tx-speed">{{ _('upload', '上传') }}</th>
        <th>{{ _('upload', '上传') }}</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
</table>
<button  id="refresh" class="btn btn-primary">{{ _('Get New Proxies', '获得新代理') }} ({{ last_refresh_started_at.strftime('%H:%M:%S') }})</button>
<script src="/assets/jquery.min.js"></script>
<script src="/assets/bootstrap/js/bootstrap.min.js"></script>
<script src="/assets/tablesort.min.js"></script>
<script src="/assets/visibility.core.js"></script>
<script src="/assets/visibility.timer.js"></script>
<script>
    $(document).ready(function() {

        var tablesort = new Tablesort($('#proxies')[0]);

        function showHideSpeed() {
            if (typeof(this.orientation) === "undefined" || window.orientation == -90 || window.orientation == 90) {
                $('#proxies').removeClass('portrait');
            } else {
                $('#proxies').addClass('portrait');
            }
        }

        function refreshProxyList() {
            $('#proxies tbody').load('/proxies?list-only=True', function() {
                tablesort.refresh();
            });
        }

        $(window).bind('orientationchange', function () {
            showHideSpeed();
        });

        $('#refresh').click(function(e) {
            $.post('/refresh-proxies', function() {
                window.location.reload();
            });
            return false;
        });

        showHideSpeed();
        refreshProxyList();
        Visibility.every(1000, refreshProxyList);
    });
</script>
</body>
</html>